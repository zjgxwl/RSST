# RSST项目分析文档导航

## 📚 文档总览

本项目包含3个详细的分析文档，共计约15000字的技术分析。根据您的需求选择对应文档：

---

## 🎯 快速导航

### 👉 我想了解项目整体架构
**阅读：** [`项目分析报告.md`](./项目分析报告.md)

**内容包括：**
- ✅ 项目概览和文件结构
- ✅ 模型替换位置详解
- ✅ 剪枝方法原理（Refill & RSST）
- ✅ 算法流程图和公式
- ✅ 参数说明和实验示例

**适合：** 第一次接触项目的人，需要系统了解的研究者

---

### 👉 我想快速找到代码位置修改
**阅读：** [`代码关键位置标注.md`](./代码关键位置标注.md)

**内容包括：**
- ✅ 模型替换速查（方案1/方案2）
- ✅ 剪枝方法具体代码行号
- ✅ 函数调用关系和数据流程图
- ✅ 调试技巧和错误定位
- ✅ 快速定位表

**适合：** 需要修改代码的开发者，调试遇到问题的用户

---

### 👉 我想看具体的实现示例
**阅读：** [`模型替换和剪枝修改示例.md`](./模型替换和剪枝修改示例.md)

**内容包括：**
- ✅ 完整的模型替换示例（ResNet32/VGG/预训练模型）
- ✅ 剪枝方法修改示例（逐层剪枝/结构化剪枝/自定义criteria）
- ✅ 参数调优指南
- ✅ 实验对比脚本
- ✅ 常见问题解决方案

**适合：** 需要实际操作的实践者，想做实验对比的研究者

---

## 📋 核心问题快速索引

### Q1: 如何替换成我自己的模型？

**最快方法（3步）：**
1. 📖 打开 `模型替换和剪枝修改示例.md`
2. 📍 跳到 "一、模型替换完整示例 → 示例1"
3. ✅ 按步骤操作（约5分钟）

**详细说明：**
- 文档：`项目分析报告.md` → "二、模型替换位置详解"
- 代码位置：`代码关键位置标注.md` → "一、模型替换位置速查"

---

### Q2: 剪枝算法是如何工作的？

**快速理解：**
- 📖 `项目分析报告.md` → "三、剪枝方法详解"
- 📍 先看 "3.1 整体剪枝流程" 了解框架
- 📍 再看 "3.3 Refill算法" 或 "3.4 RSST算法" 深入细节

**代码位置：**
- 📖 `代码关键位置标注.md` → "二、剪枝方法位置标注"

---

### Q3: 如何修改剪枝方法？

**实战教程：**
- 📖 `模型替换和剪枝修改示例.md` → "二、剪枝方法修改示例"
- ✅ 示例1：逐层剪枝
- ✅ 示例2：结构化剪枝
- ✅ 示例3：自定义criteria
- ✅ 示例4：渐进式剪枝

---

### Q4: RSST算法的核心是什么？

**原理解释：**
- 📖 `项目分析报告.md` → "3.4 RSST算法详解"
- 重点看：
  - 3.4.1 算法原理
  - 3.4.2 三个关键阶段
  - 3.4.4 RSST完整流程图

**代码实现：**
- 📖 `代码关键位置标注.md` → "2.4 RSST算法三大关键函数"
- 三个核心函数：
  - `update_reg()` - 更新正则化强度（第353-404行）
  - `apply_reg()` - 应用正则化到梯度（第458-483行）
  - `train()` - 训练循环集成（第406-457行）

---

### Q5: 参数应该怎么调？

**调优指南：**
- 📖 `模型替换和剪枝修改示例.md` → "三、参数调优指南"
- 包含：
  - RSST核心参数（reg_granularity_prune, RST_schedule, criteria）
  - 训练参数（学习率、batch size）
  - 剪枝策略（剪枝率、次数、rewind）

**参数说明：**
- 📖 `项目分析报告.md` → "四、关键参数说明"

---

### Q6: 如何对比不同算法的效果？

**实验脚本：**
- 📖 `模型替换和剪枝修改示例.md` → "四、实验对比示例"
- 包含：
  - 4.1 对比实验脚本（RSST vs Refill vs IMP）
  - 4.2 结果分析脚本
  - 4.3 可视化剪枝过程

---

### Q7: 代码报错了怎么办？

**调试指南：**
- 📖 `代码关键位置标注.md` → "五、调试技巧"
- 📖 `模型替换和剪枝修改示例.md` → "五、常见问题和解决方案"

**常见错误：**
- OOM（显存不足）
- 训练精度下降过快
- 正则化不生效
- 结果不可复现

---

## 📊 文档内容对比

| 特性 | 项目分析报告 | 代码关键位置标注 | 模型替换和剪枝修改示例 |
|-----|------------|----------------|-------------------|
| **字数** | ~5000字 | ~4500字 | ~5500字 |
| **侧重点** | 理论原理 | 代码导航 | 实战操作 |
| **难度** | ⭐⭐⭐ | ⭐⭐ | ⭐ |
| **代码量** | 少量示例 | 行号标注 | 完整示例 |
| **适合** | 理解算法 | 修改代码 | 动手实验 |

---

## 🎓 推荐阅读路径

### 路径1：新手入门（总计30分钟）
```
1. 项目分析报告.md
   └─ 一、项目概览（5分钟）
   └─ 二、模型替换位置详解（10分钟）
   └─ 三、剪枝方法详解 → 3.1-3.2（15分钟）

2. 代码关键位置标注.md
   └─ 一、模型替换位置速查（5分钟）
   └─ 浏览流程图（5分钟）
```

### 路径2：快速上手（总计20分钟）
```
1. 代码关键位置标注.md
   └─ 一、模型替换位置速查（5分钟）
   └─ 二、剪枝方法位置标注（10分钟）

2. 模型替换和剪枝修改示例.md
   └─ 一、模型替换完整示例 → 示例1（5分钟）
   └─ 运行代码（实际操作）
```

### 路径3：深入研究（总计60分钟）
```
1. 项目分析报告.md（30分钟）
   └─ 完整阅读所有章节
   └─ 重点关注 3.4 RSST算法详解

2. 代码关键位置标注.md（15分钟）
   └─ 研究路径（深入算法细节）

3. 模型替换和剪枝修改示例.md（15分钟）
   └─ 四、实验对比示例
   └─ 六、高级技巧
```

### 路径4：问题解决（按需）
```
1. 遇到bug/错误
   └─ 代码关键位置标注.md → 五、调试技巧
   └─ 模型替换和剪枝修改示例.md → 五、常见问题

2. 想改进算法
   └─ 项目分析报告.md → 三、剪枝方法详解
   └─ 模型替换和剪枝修改示例.md → 二、剪枝方法修改示例

3. 想做实验对比
   └─ 模型替换和剪枝修改示例.md → 四、实验对比示例
```

---

## 🔍 关键词索引

### 模型相关
- **模型替换**: `项目分析报告.md`→第二章, `代码关键位置标注.md`→第一章, `模型替换和剪枝修改示例.md`→第一章
- **ResNet**: `utils.py`第92-96行
- **VGG**: `utils.py`第98-100行
- **预训练模型**: `模型替换和剪枝修改示例.md`→示例3

### 剪枝算法
- **L1剪枝**: `pruning_utils.py`第6-22行
- **Refill算法**: `pruning_utils.py`第77-243行, `项目分析报告.md`→3.3节
- **RSST算法**: `main_imp_fillback.py`第334-483行, `项目分析报告.md`→3.4节
- **结构化剪枝**: `模型替换和剪枝修改示例.md`→示例2

### 核心函数
- **pruning_model**: `pruning_utils.py`第6行, `main_imp_fillback.py`第321行
- **update_reg**: `main_imp_fillback.py`第353行
- **apply_reg**: `main_imp_fillback.py`第458行
- **train**: `main_imp_fillback.py`第406行

### 参数设置
- **剪枝率**: `--rate`, 默认0.2
- **正则化粒度**: `--reg_granularity_prune`, 默认1.0
- **Schedule**: `--RST_schedule`, 默认exp_custom_exponents
- **Criteria**: `--criteria`, 默认l1

---

## 💡 使用建议

### 建议1：按顺序阅读文档
如果您有充足时间，建议按以下顺序完整阅读：
1. 项目分析报告.md（理解原理）
2. 代码关键位置标注.md（找到位置）
3. 模型替换和剪枝修改示例.md（动手实践）

### 建议2：问题驱动阅读
如果您时间有限，直接在本文档查找问题关键词，跳转到对应章节。

### 建议3：边读边实践
每读完一个示例，立即在代码中尝试，这样理解更深刻。

### 建议4：做笔记
在关键位置做标记，记录自己的理解和修改。

### 建议5：参考原始代码
文档中的行号可能因版本不同略有偏差，以实际代码为准。

---

## 📞 文档反馈

如果您发现文档中的错误或有改进建议，欢迎提出。

**文档特点：**
- ✅ 详细的代码行号标注
- ✅ 完整的示例代码
- ✅ 丰富的流程图和表格
- ✅ 实用的调试技巧
- ✅ 真实的实验脚本

---

## 📌 重要提示

1. **版本兼容性**：文档基于当前代码版本编写，如代码更新可能需要调整
2. **环境要求**：确保已安装必要的依赖（PyTorch, torchvision, wandb等）
3. **GPU需求**：RSST算法建议使用GPU，至少4GB显存
4. **时间预估**：完整训练一次实验（20轮剪枝×120 epochs）约需数小时到数天

---

## 🎉 快速开始

如果您急于开始，直接执行：

```bash
# 1. 查看当前配置
python main_imp_fillback.py --help

# 2. 运行默认RSST实验
python main_imp_fillback.py \
    --dataset cifar100 \
    --arch res20s \
    --struct rsst \
    --epochs 120 \
    --pruning_times 20

# 3. 同时阅读文档了解原理
# 推荐从"项目分析报告.md"的第一章开始
```

---

**文档生成时间：** 2026年1月5日  
**文档版本：** v1.0  
**分析文件总数：** 8个核心文件  
**总文档字数：** 约15000字  
**预计阅读时间：** 60-90分钟（完整阅读）

**祝您使用愉快！ 🚀**

